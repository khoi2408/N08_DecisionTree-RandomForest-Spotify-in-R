spotify <- read.csv('../data.csv')
spotify$X<-NULL
spotify$song_title<-NULL
spotify$artist<-NULL
spotify$target<-as.factor(spotify$target)
str(spotify)
library(rpart)
library(rpart.plot)
library(caret)
set.seed(1)
index <- createDataPartition(spotify$target, p=0.8, list=FALSE)
train <- spotify[index,]
test <- spotify[-index,]
str(train)
model <- rpart(target~., data=train)
prp(model, type=1, extra=1)
str(test)
pred <- predict(model, test, type="class")
confusionMatrix(pred, test$target)
library(randomForest)
model2 <- randomForest(target~., train, ntree=50)
varImpPlot(model2)
pred2 <- predict(model2, test)
confusionMatrix(pred2, test$target)
---
title: "doan"
output: html_document
date: '2022-03-18'
---
View(test)
View(test)
View(train)
View(spotify)
View(model)
View(index)
View(model)
View(train)
library(DSvsRF)
spotify <- read.csv('../data.csv')
spotify$X<-NULL
spotify$song_title<-NULL
spotify$artist<-NULL
spotify$target<-as.factor(spotify$target)
str(spotify)
library(rpart)
library(rpart.plot)
library(caret)
set.seed(1)
index <- createDataPartition(spotify$target, p=0.8, list=FALSE)
train <- spotify[index,]
test <- spotify[-index,]
str(train)
model <- rpart(target~., data=train)
prp(model, type=1, extra=1)
str(test)
pred <- predict(model, test, type="class")
confusionMatrix(pred, test$target)
library(randomForest)
model2 <- randomForest(target~., train, ntree=50)
varImpPlot(model2)
pred2 <- predict(model2, test)
confusionMatrix(pred2, test$target)
library(DSvsRF)
View(index)
library(caret)
prp(model, type=1, extra=1)
spotify <- read.csv('../data.csv')
spotify$X<-NULL
spotify$song_title<-NULL
spotify$artist<-NULL
spotify$target<-as.factor(spotify$target)
str(spotify)
library(rpart)
library(rpart.plot)
library(caret)
set.seed(1)
index <- createDataPartition(spotify$target, p=0.8, list=FALSE)
train <- spotify[index,]
test <- spotify[-index,]
str(train)
model <- rpart(target~., data=train)
prp(model, type=1, extra=1)
str(test)
pred <- predict(model, test, type="class")
confusionMatrix(pred, test$target)
library(randomForest)
model2 <- randomForest(target~., train, ntree=50)
varImpPlot(model2)
pred2 <- predict(model2, test)
confusionMatrix(pred2, test$target)
spotify <- read.csv('../data.csv')
spotify$X<-NULL
spotify$song_title<-NULL
spotify$artist<-NULL
spotify$target<-as.factor(spotify$target)
str(spotify)
library(rpart)
library(rpart.plot)
library(caret)
set.seed(1)
index <- createDataPartition(spotify$target, p=0.8, list=FALSE)
train <- spotify[index,]
test <- spotify[-index,]
str(train)
model <- rpart(target~., data=train)
prp(model, type=1, extra=1)
str(test)
pred <- predict(model, test, type="class")
confusionMatrix(pred, test$target)
library(randomForest)
model2 <- randomForest(target~., train, ntree=50)
varImpPlot(model2)
pred2 <- predict(model2, test)
confusionMatrix(pred2, test$target)
spotify <- read.csv('../data.csv')
spotify$X<-NULL
spotify$song_title<-NULL
spotify$artist<-NULL
spotify$target<-as.factor(spotify$target)
str(spotify)
library(rpart)
library(rpart.plot)
library(caret)
set.seed(1)
index <- createDataPartition(spotify$target, p=0.8, list=FALSE)
train <- spotify[index,]
test <- spotify[-index,]
str(train)
model <- rpart(target~., data=train)
prp(model, type=1, extra=1)
str(test)
pred <- predict(model, test, type="class")
confusionMatrix(pred, test$target)
library(randomForest)
model2 <- randomForest(target~., train, ntree=50)
model2 <- randomForest(target~., train, ntree=50)
varImpPlot(model2)
pred2 <- predict(model2, test)
confusionMatrix(pred2, test$target)
prp(model, type=0, extra=1)
prp(model, type=1, extra=0)
prp(model, type=0, extra=0)
prp(model, type=1, extra=1)
spotify <- read.csv('../data.csv')
spotify$X<-NULL
spotify$song_title<-NULL
spotify$artist<-NULL
spotify$target<-as.factor(spotify$target)
str(spotify)
library(rpart)
library(rpart.plot)
library(caret)
set.seed(1)
index <- createDataPartition(spotify$target, p=0.8, list=FALSE)
train <- spotify[index,]
test <- spotify[-index,]
str(train)
model <- rpart(target~., data=train)
prp(model, type=1, extra=1)
str(test)
pred <- predict(model, test, type="class")
confusionMatrix(pred, test$target)
library(randomForest)
model2 <- randomForest(target~., train, ntree=50)
model2 <- randomForest(target~., train, ntree=50)
varImpPlot(model2)
pred2 <- predict(model2, test)
confusionMatrix(pred2, test$target)
spotify <- read.csv('../data.csv')
spotify$X<-NULL
spotify$song_title<-NULL
spotify$artist<-NULL
spotify$target<-as.factor(spotify$target)
str(spotify)
library(rpart)
library(rpart.plot)
library(caret)
set.seed(1)
index <- createDataPartition(spotify$target, p=0.8, list=FALSE)
train <- spotify[index,]
test <- spotify[-index,]
str(train)
model <- rpart(target~., data=train)
prp(model, type=1, extra=1)
str(test)
pred <- predict(model, test, type="class")
confusionMatrix(pred, test$target)
library(randomForest)
model2 <- randomForest(target~., train, ntree=50)
varImpPlot(model2)
pred2 <- predict(model2, test)
confusionMatrix(pred2, test$target)
prp(spotify, type=1, extra=1)
prp(model, main = "Information Gain", type=1, extra=1)
prp(model, type=5, extra=3)
prp(model2, type=5, extra=3)
prp(model2, type=1, extra=1)
prp(model, type=6, extra=3)
prp(model, type=0, extra=0)
prp(model, type=0, extra=1)
prp(model, type=1, extra=1)
prp(model, type=1, extra=2)
prp(model, type=2, extra=1)
prp(model, type=2, extra=2)
prp(model, type=2, extra=3)
prp(model, type=3, extra=3)
spotify <- read.csv('../data.csv')
spotify$X<-NULL
spotify$song_title<-NULL
spotify$artist<-NULL
spotify$target<-as.factor(spotify$target)
str(spotify)
library(rpart)
library(rpart.plot)
library(caret)
set.seed(1)
index <- createDataPartition(spotify$target, p=0.8, list=FALSE)
train <- spotify[index,]
test <- spotify[-index,]
str(train)
model <- rpart(target~., data=train)
prp(model, type=1, extra=1)
str(test)
pred <- predict(model, test, type="class")
confusionMatrix(pred, test$target)
library(randomForest)
model2 <- randomForest(target~., train, ntree=50)
varImpPlot(model2)
pred2 <- predict(model2, test)
confusionMatrix(pred2, test$target)
prp(model, type=5, extra=3)
rpart.plot(model, main = "Information Gain", type = 5, extra = 3)
rpart.plot(model, main = "Entropy", type = 5, extra = 3)
rpart.plot(model, main = "Gini", type = 1, extra = 1)
tree.imb <- rpart(spotify$target, data = spotify.train, parms = list(split = "gini"))
tree <- createDataPartition(spotify$target, p=0.8, parms = list(split = "gini"))
tree <- createDataPartition(spotify$target, p=0.8, list="FALSE"gini")
tree <- createDataPartition(spotify$target, p=0.8, list="gini")
tree <- createDataPartition(spotify$target, parms = list(split = "gini"))
tree <- createDataPartition(spotify$target, list(split = "gini"))
tree <- createDataPartition(spotify$target, p=0.8, list=TRUE)
train <- spotify[tree,]
View(tree)
library(ROSE)
data(spotify)
data(hacide)
table(train)
table(hacide.train$target)
tree.imb <- rpart(target~., data=train, parms = list(split = "gini"))
pred.tree.imb <- predict(tree.imb, newdata = test)
rpart.plot(tree.imb, main = "Gini Index", type = 5, extra = 3)
tree.imb <- rpart(target~., data=train, parms = list(split = "gini"))
pred.tree.imb <- predict(tree.imb, newdata = test)
accuracy.meas(test$target, pred.tree.imb[,2])
roc.curve(test$target, pred.tree.imb[,2], plotit = T)
rpart.plot(tree.imb, main = "Information Gain", type = 5, extra = 3)
tree.imb <- rpart(target~., data=train, parms = list(split = "gini"))
pred.tree.imb <- predict(tree.imb, newdata = test)
accuracy.meas(test$target, pred.tree.imb[,2])
roc.curve(test$target, pred.tree.imb[,2], plotit = T, main = "Gini index")
rpart.plot(tree.imb, main = "Gini Index", type = 5, extra = 3)
tree.imb <- rpart(target~., data=train, parms = list(split = "information"))
pred.tree.imb <- predict(tree.imb, newdata = test)
accuracy.meas(test$target, pred.tree.imb[,2])
roc.curve(test$target, pred.tree.imb[,2], plotit = T)
rpart.plot(tree.imb, main = "Entropy", type = 5, extra = 3)
varImpPlot(model2)
spotify <- read.csv('../data.csv')
spotify$X<-NULL
spotify$song_title<-NULL
spotify$artist<-NULL
spotify$target<-as.factor(spotify$target)
str(spotify)
library(rpart)
library(rpart.plot)
library(caret)
set.seed(1)
index <- createDataPartition(spotify$target, p=0.8, list=FALSE)
train <- spotify[index,]
test <- spotify[-index,]
str(train)
model <- rpart(target~., data=train)
prp(model, type=1, extra=1)
str(test)
pred <- predict(model, test, type="class")
confusionMatrix(pred, test$target)
library(randomForest)
model2 <- randomForest(target~., train, ntree=50)
varImpPlot(model2)
pred2 <- predict(model2, test)
confusionMatrix(pred2, test$target)
tree.imb <- rpart(target~., data=train, parms = list(split = "gini"))
pred.tree.imb <- predict(tree.imb, newdata = test)
accuracy.meas(test$target, pred.tree.imb[,2])
library(ROSE)
accuracy.meas(test$target, pred.tree.imb[,2])
roc.curve(test$target, pred.tree.imb[,2], plotit = T, main = "Gini index")
rpart.plot(tree.imb, main = "Gini Index", type = 5, extra = 3)
tree.imb <- rpart(target~., data=train, parms = list(split = "information"))
pred.tree.imb <- predict(tree.imb, newdata = test)
accuracy.meas(test$target, pred.tree.imb[,2])
roc.curve(test$target, pred.tree.imb[,2], plotit = T)
rpart.plot(tree.imb, main = "Entropy", type = 5, extra = 3)
spotify <- read.csv('../data.csv')
spotify$X<-NULL
spotify$song_title<-NULL
spotify$artist<-NULL
spotify$target<-as.factor(spotify$target)
str(spotify)
library(rpart)
library(rpart.plot)
library(caret)
set.seed(1)
index <- createDataPartition(spotify$target, p=0.8, list=FALSE)
train <- spotify[index,]
test <- spotify[-index,]
str(train)
model <- rpart(target~., data=train)
prp(model, type=1, extra=1)
str(test)
pred <- predict(model, test, type="class")
confusionMatrix(pred, test$target)
library(randomForest)
model2 <- randomForest(target~., train, ntree=50)
varImpPlot(model2)
pred2 <- predict(model2, test)
confusionMatrix(pred2, test$target)
library(ROSE)
tree.imb <- rpart(target~., data=train, parms = list(split = "gini"))
pred.tree.imb <- predict(tree.imb, newdata = test)
accuracy.meas(test$target, pred.tree.imb[,2])
accuracy.meas(test$target, pred.tree.imb[,2])
roc.curve(test$target, pred.tree.imb[,2], plotit = T, main = "Gini index")
rpart.plot(tree.imb, main = "Gini Index", type = 5, extra = 3)
tree.imb <- rpart(target~., data=train, parms = list(split = "information"))
pred.tree.imb <- predict(tree.imb, newdata = test)
accuracy.meas(test$target, pred.tree.imb[,2])
roc.curve(test$target, pred.tree.imb[,2], plotit = T)
rpart.plot(tree.imb, main = "Entropy", type = 5, extra = 3)
